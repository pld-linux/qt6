From abe27e1f0e7f752b9ad4d5c1a05ee50cc19a51aa Mon Sep 17 00:00:00 2001
From: Martin Negyokru <negyokru@inf.u-szeged.hu>
Date: Thu, 10 Aug 2023 15:51:57 +0200
Subject: [PATCH] Fix close button in devtools

Handle CloseWindow call coming from DevtoolsUIBindings.

Pick-to: 6.6
Fixes: QTBUG-115976
Change-Id: If58a96e3901234696c55c9c1402c645ba7a8576b
---

diff --git a/src/core/devtools_frontend_qt.cpp b/src/core/devtools_frontend_qt.cpp
index 8c537a6..49fc0d3 100644
--- a/src/core/devtools_frontend_qt.cpp
+++ b/src/core/devtools_frontend_qt.cpp
@@ -209,4 +209,9 @@
     web_contents()->ClosePage();
 }
 
+void DevToolsFrontendQt::CloseWindow()
+{
+    web_contents()->Close();
+}
+
 } // namespace QtWebEngineCore
diff --git a/src/core/devtools_frontend_qt.h b/src/core/devtools_frontend_qt.h
index a22bb05..ec7ccce 100644
--- a/src/core/devtools_frontend_qt.h
+++ b/src/core/devtools_frontend_qt.h
@@ -61,7 +61,7 @@
     void OnLoadCompleted() override;
 
     void InspectElementCompleted() override{};
-    void CloseWindow() override{};
+    void CloseWindow() override;
     void Inspect(scoped_refptr<content::DevToolsAgentHost>) override{};
     void SetInspectedPageBounds(const gfx::Rect &) override{};
     void SetIsDocked(bool) override{};
